
import javax.swing.DefaultComboBoxModel;
import javax.swing.DefaultListModel;

/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */

/**
 *
 * @author Alexander
 */
public class PlaceOrderMenuGUI extends javax.swing.JFrame {
    
    private static final java.util.logging.Logger logger = java.util.logging.Logger.getLogger(PlaceOrderMenuGUI.class.getName());
    private OrderPlacer op;
    private Customer customer;
    private OrderManager gom;
    private Menu menu;
    private OrderAddressPlacer oap;
    private OrderPaymentPlacer opp;
    private Inventory inventory;
    private DefaultComboBoxModel addressModel;
    private DefaultComboBoxModel payMethodModel;
    
    /**
     * Creates new form PlaceOrderMenuGUI
     */
    public PlaceOrderMenuGUI() {
        addressModel = new DefaultComboBoxModel();
        payMethodModel = new DefaultComboBoxModel();
        initComponents();
    }
    
    public PlaceOrderMenuGUI(Customer customer, OrderManager gom, Menu menu,
            Inventory inventory){
        this();
        this.customer = customer;
        this.gom = gom;
        this.menu = menu;
        this.inventory = inventory;
        
    }
    
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jScrollPane1 = new javax.swing.JScrollPane();
        jList1 = new javax.swing.JList<>();
        placeOrderTabPane = new javax.swing.JTabbedPane();
        placeOrderPanel = new javax.swing.JPanel();
        addToOrderLbl = new javax.swing.JLabel();
        setAddressPanel = new javax.swing.JPanel();
        selectAddressLbl = new javax.swing.JLabel();
        selectedAddressPanel = new javax.swing.JPanel();
        selectedAddressLabel = new javax.swing.JLabel();
        mngAddrBtn = new javax.swing.JButton();
        selectAddressCB = new javax.swing.JComboBox<>();
        setPaymentPanel = new javax.swing.JPanel();
        selectPayMthdLbl = new javax.swing.JLabel();
        payMthdPanel = new javax.swing.JPanel();
        currPayMthdLbl = new javax.swing.JLabel();
        mngPayMthdBtn = new javax.swing.JButton();
        payMthdCB = new javax.swing.JComboBox<>();
        confirmPanel = new javax.swing.JPanel();
        confirmOrderLbl = new javax.swing.JLabel();
        orderInfoScrlPne = new javax.swing.JScrollPane();
        orderInfoLbl = new javax.swing.JLabel();
        placeOrderBtn = new javax.swing.JButton();
        cancelBtn = new javax.swing.JButton();

        jList1.setModel(new javax.swing.AbstractListModel<String>() {
            String[] strings = { "Item 1", "Item 2", "Item 3", "Item 4", "Item 5" };
            public int getSize() { return strings.length; }
            public String getElementAt(int i) { return strings[i]; }
        });
        jScrollPane1.setViewportView(jList1);

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Place an Order");
        addWindowFocusListener(new java.awt.event.WindowFocusListener() {
            public void windowGainedFocus(java.awt.event.WindowEvent evt) {
                formWindowGainedFocus(evt);
            }
            public void windowLostFocus(java.awt.event.WindowEvent evt) {
            }
        });

        placeOrderTabPane.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                placeOrderTabPaneStateChanged(evt);
            }
        });

        addToOrderLbl.setFont(new java.awt.Font("Segoe UI", 0, 20)); // NOI18N
        addToOrderLbl.setText("Add to Your Order");

        javax.swing.GroupLayout placeOrderPanelLayout = new javax.swing.GroupLayout(placeOrderPanel);
        placeOrderPanel.setLayout(placeOrderPanelLayout);
        placeOrderPanelLayout.setHorizontalGroup(
            placeOrderPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(placeOrderPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(addToOrderLbl)
                .addContainerGap(334, Short.MAX_VALUE))
        );
        placeOrderPanelLayout.setVerticalGroup(
            placeOrderPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(placeOrderPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(addToOrderLbl)
                .addContainerGap(288, Short.MAX_VALUE))
        );

        placeOrderTabPane.addTab("Place your Order", placeOrderPanel);

        selectAddressLbl.setFont(new java.awt.Font("Segoe UI", 0, 20)); // NOI18N
        selectAddressLbl.setText("Select Your Address");

        selectedAddressPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createEtchedBorder(), "Selected Address"));

        selectedAddressLabel.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        selectedAddressLabel.setText("<html>address line 1<br>address line 2<br>city, state, 00000");

        javax.swing.GroupLayout selectedAddressPanelLayout = new javax.swing.GroupLayout(selectedAddressPanel);
        selectedAddressPanel.setLayout(selectedAddressPanelLayout);
        selectedAddressPanelLayout.setHorizontalGroup(
            selectedAddressPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(selectedAddressPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(selectedAddressLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 225, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(248, Short.MAX_VALUE))
        );
        selectedAddressPanelLayout.setVerticalGroup(
            selectedAddressPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(selectedAddressPanelLayout.createSequentialGroup()
                .addComponent(selectedAddressLabel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        mngAddrBtn.setText("Manage Addresses");
        mngAddrBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mngAddrBtnActionPerformed(evt);
            }
        });

        selectAddressCB.setModel(addressModel);
        selectAddressCB.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                selectAddressCBItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout setAddressPanelLayout = new javax.swing.GroupLayout(setAddressPanel);
        setAddressPanel.setLayout(setAddressPanelLayout);
        setAddressPanelLayout.setHorizontalGroup(
            setAddressPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(setAddressPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(setAddressPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(selectedAddressPanel, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(setAddressPanelLayout.createSequentialGroup()
                        .addComponent(selectAddressLbl)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(setAddressPanelLayout.createSequentialGroup()
                        .addComponent(selectAddressCB, javax.swing.GroupLayout.PREFERRED_SIZE, 218, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(mngAddrBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 218, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        setAddressPanelLayout.setVerticalGroup(
            setAddressPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(setAddressPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(setAddressPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(mngAddrBtn)
                    .addGroup(setAddressPanelLayout.createSequentialGroup()
                        .addComponent(selectAddressLbl)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(selectedAddressPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(selectAddressCB, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(164, Short.MAX_VALUE))
        );

        placeOrderTabPane.addTab("Set Address", setAddressPanel);

        selectPayMthdLbl.setFont(new java.awt.Font("Segoe UI", 0, 20)); // NOI18N
        selectPayMthdLbl.setText("Select Your Method of Payment");

        payMthdPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        currPayMthdLbl.setText("Current Pay Method: pay method");

        javax.swing.GroupLayout payMthdPanelLayout = new javax.swing.GroupLayout(payMthdPanel);
        payMthdPanel.setLayout(payMthdPanelLayout);
        payMthdPanelLayout.setHorizontalGroup(
            payMthdPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(payMthdPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(currPayMthdLbl)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        payMthdPanelLayout.setVerticalGroup(
            payMthdPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(payMthdPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(currPayMthdLbl, javax.swing.GroupLayout.DEFAULT_SIZE, 54, Short.MAX_VALUE)
                .addContainerGap())
        );

        mngPayMthdBtn.setText("Manage Payment Methods");

        payMthdCB.setModel(payMethodModel);
        payMthdCB.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                payMthdCBItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout setPaymentPanelLayout = new javax.swing.GroupLayout(setPaymentPanel);
        setPaymentPanel.setLayout(setPaymentPanelLayout);
        setPaymentPanelLayout.setHorizontalGroup(
            setPaymentPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(setPaymentPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(setPaymentPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(payMthdPanel, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(setPaymentPanelLayout.createSequentialGroup()
                        .addComponent(selectPayMthdLbl)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(setPaymentPanelLayout.createSequentialGroup()
                        .addComponent(payMthdCB, javax.swing.GroupLayout.PREFERRED_SIZE, 211, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 69, Short.MAX_VALUE)
                        .addComponent(mngPayMthdBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 211, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        setPaymentPanelLayout.setVerticalGroup(
            setPaymentPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(setPaymentPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(selectPayMthdLbl)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(payMthdPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(setPaymentPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(payMthdCB, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(mngPayMthdBtn))
                .addContainerGap(183, Short.MAX_VALUE))
        );

        placeOrderTabPane.addTab("Set Payment", setPaymentPanel);

        confirmOrderLbl.setFont(new java.awt.Font("Segoe UI", 0, 20)); // NOI18N
        confirmOrderLbl.setText("Confirm Your Order");

        orderInfoScrlPne.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createEtchedBorder(), "Order Information"));

        orderInfoLbl.setText("Order Information goes here");
        orderInfoScrlPne.setViewportView(orderInfoLbl);

        placeOrderBtn.setText("Place Order");

        cancelBtn.setText("Cancel Order");
        cancelBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cancelBtnActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout confirmPanelLayout = new javax.swing.GroupLayout(confirmPanel);
        confirmPanel.setLayout(confirmPanelLayout);
        confirmPanelLayout.setHorizontalGroup(
            confirmPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(confirmPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(confirmPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(orderInfoScrlPne)
                    .addGroup(confirmPanelLayout.createSequentialGroup()
                        .addComponent(confirmOrderLbl)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(confirmPanelLayout.createSequentialGroup()
                        .addComponent(placeOrderBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 191, Short.MAX_VALUE)
                        .addComponent(cancelBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        confirmPanelLayout.setVerticalGroup(
            confirmPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(confirmPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(confirmOrderLbl)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(orderInfoScrlPne, javax.swing.GroupLayout.PREFERRED_SIZE, 234, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(confirmPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(placeOrderBtn)
                    .addComponent(cancelBtn))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        placeOrderTabPane.addTab("Confirm Order", confirmPanel);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(placeOrderTabPane, javax.swing.GroupLayout.DEFAULT_SIZE, 484, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(placeOrderTabPane, javax.swing.GroupLayout.DEFAULT_SIZE, 356, Short.MAX_VALUE)
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void mngAddrBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mngAddrBtnActionPerformed
        // TODO add your handling code here:
        new AddressesSubmenuGUI(customer).setVisible(true);
    }//GEN-LAST:event_mngAddrBtnActionPerformed

    private void placeOrderTabPaneStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_placeOrderTabPaneStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_placeOrderTabPaneStateChanged

    private void selectAddressCBItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_selectAddressCBItemStateChanged
        // TODO add your handling code here:
        
        int index = selectAddressCB.getSelectedIndex();
        
        if(index != -1){
            AddressManager am = customer.getAddressManager();
            Address addr = am.searchAddress(index + 1);
            showAddress(addr);
        }
        
    }//GEN-LAST:event_selectAddressCBItemStateChanged

    private void formWindowGainedFocus(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowGainedFocus
        // TODO add your handling code here:
        setAddrCB();
        setPayMthdCB();
    }//GEN-LAST:event_formWindowGainedFocus

    private void payMthdCBItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_payMthdCBItemStateChanged
        // TODO add your handling code here:
        String payMethod = (String)payMthdCB.getSelectedItem();
        
        showPayMethod(payMethod);
    }//GEN-LAST:event_payMthdCBItemStateChanged

    private void cancelBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cancelBtnActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cancelBtnActionPerformed

    private void setAddrCB(){
        addressModel = new DefaultComboBoxModel();
        AddressManager am = customer.getAddressManager();
        int primaryId = am.getPrimaryAddressID();
        
        for(int i = 1; i <= am.getNumAddresses(); i++){
            Address addr = am.searchAddress(i);
            if(addr != null){
                String addrStr = "Address " + addr.getAddressID();
                if(addr.isPrimary()){
                    addrStr += "(Primary)";
                    showAddress(addr);
                }
                addressModel.addElement(addrStr);
            }       
        } 
        selectAddressCB.setModel(addressModel);
        if(primaryId != 0){selectAddressCB.setSelectedIndex(primaryId - 1);}
        selectAddressCB.updateUI();
    }
    
    private void showAddress(Address addr){
        selectedAddressLabel.setText(addr.toString());
    }
    
    private void setPayMthdCB(){
        payMethodModel = new DefaultComboBoxModel();
        Payment payment = customer.getPayment();
        
        for(String payMethod: payment.getPayMethods()){
            payMethodModel.addElement(payMethod);
        }
        
        payMthdCB.setModel(payMethodModel);
        showPayMethod(payment.getCurrentPayMethod());
        payMthdCB.updateUI();
    }
    
    private void showPayMethod(String payMethod){
        currPayMthdLbl.setText("Current Payment Method: " + payMethod);
    }
    
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Windows".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ReflectiveOperationException | javax.swing.UnsupportedLookAndFeelException ex) {
            logger.log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(() -> new PlaceOrderMenuGUI().setVisible(true));
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel addToOrderLbl;
    private javax.swing.JButton cancelBtn;
    private javax.swing.JLabel confirmOrderLbl;
    private javax.swing.JPanel confirmPanel;
    private javax.swing.JLabel currPayMthdLbl;
    private javax.swing.JList<String> jList1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JButton mngAddrBtn;
    private javax.swing.JButton mngPayMthdBtn;
    private javax.swing.JLabel orderInfoLbl;
    private javax.swing.JScrollPane orderInfoScrlPne;
    private javax.swing.JComboBox<String> payMthdCB;
    private javax.swing.JPanel payMthdPanel;
    private javax.swing.JButton placeOrderBtn;
    private javax.swing.JPanel placeOrderPanel;
    private javax.swing.JTabbedPane placeOrderTabPane;
    private javax.swing.JComboBox<String> selectAddressCB;
    private javax.swing.JLabel selectAddressLbl;
    private javax.swing.JLabel selectPayMthdLbl;
    private javax.swing.JLabel selectedAddressLabel;
    private javax.swing.JPanel selectedAddressPanel;
    private javax.swing.JPanel setAddressPanel;
    private javax.swing.JPanel setPaymentPanel;
    // End of variables declaration//GEN-END:variables
}
